plugins {
   id("us.ihmc.ihmc-build") version "0.20.1"
   id("us.ihmc.ihmc-ci") version "5.3"
   id("us.ihmc.ihmc-cd") version "1.8"
   id("org.hidetake.ssh") version "2.9.0"
   id("application")
}

ihmc {
   group = "us.ihmc"
   version = "1.2.6"
   vcsUrl = "https://github.com/ihmcrobotics/ihmc-realtime"
   openSource = true

   configureDependencyResolution()
   configurePublications()
}

mainDependencies {
   compile("us.ihmc:ihmc-native-library-loader:1.2.1")
}

remotes {
   rtComputer {
      host = remoteHost
      user = remoteUser
      password = remotePass
   }
}

mainClassName = 'us.ihmc.realtime.TestBarrierSchedulerCyclic'
task deploy(dependsOn: ['installDist']) {
  doLast {
    ssh.run {
      session(remotes.rtComputer) {
        put(from: "build/install/ihmc-realtime", into: '.')
        execute('chmod +x ' + './ihmc-realtime/bin/ihmc-realtime')
      }
    }
  }
}
